\documentclass[10pt,landscape,twocolumn]{ctexart}
\usepackage[utf8]{inputenc}
\usepackage{geometry}
\usepackage{listings}
\usepackage{xeCJK}
\usepackage{fontspec}
\usepackage{hyperref}
\usepackage{tocloft}
\usepackage{fancyhdr}
\usepackage{xcolor}
\usepackage{multicol}
\usepackage{titlesec}
\usepackage{enumitem}

% 确保使用UTF-8编码
\XeTeXinputencoding "utf-8"

% 横版双列页面设置
\geometry{
    landscape,
    a4paper,
    left=1.5cm,
    right=1.5cm,
    top=2cm,
    bottom=2cm,
    columnsep=1cm
}

% 标题格式设置
\titleformat{\section}
{\normalfont\large\bfseries\color{blue!70!black}}
{\thesection}{1em}{}

\titleformat{\subsection}
{\normalfont\normalsize\bfseries\color{green!60!black}}
{\thesubsection}{0.8em}{}

\titleformat{\subsubsection}
{\normalfont\footnotesize\bfseries\color{orange!80!black}}
{\thesubsubsection}{0.5em}{}

% 调整章节间距 - 极度紧凑
\titlespacing*{\section}{0pt}{4pt plus 0.5pt minus 0.5pt}{2pt plus 0.5pt minus 0.5pt}
\titlespacing*{\subsection}{0pt}{3pt plus 0.5pt minus 0.5pt}{1.5pt plus 0.5pt minus 0.5pt}
\titlespacing*{\subsubsection}{0pt}{2pt plus 0.5pt minus 0.5pt}{1pt plus 0.5pt minus 0.5pt}

% 字体设置 - 针对小字体优化，修复中文渲染
\setmainfont{Times New Roman}
% 中文字体设置 - 确保中文正确渲染
\setCJKmainfont[BoldFont=SimHei, ItalicFont=KaiTi]{SimSun}
\setCJKsansfont{SimHei}
\setCJKmonofont[Scale=0.85]{SimSun}

% 为了支持Fira Code连字符，使用特殊设置
\newfontfamily\firafont[Ligatures=TeX,Contextuals=Alternate]{Fira Code}
\newcommand{\firatextstyle}{\firafont}

% ctexart已经定义了这些字体，所以不需要重新定义
% 确保listings中的中文注释能正确显示
\lstset{
    language=C++,
    basicstyle=\tiny\firatextstyle,  % 使用支持连字符的Fira Code
    keywordstyle=\color{blue}\bfseries,
    commentstyle=\color{green!50!black},  % 简化中文注释样式
    stringstyle=\color{red},
    numberstyle=\tiny\color{gray},
    numbers=left,
    numbersep=3pt,
    frame=single,
    frameround=tttt,
    framerule=0.3pt,
    breaklines=true,
    breakatwhitespace=false,
    tabsize=2,
    showspaces=false,
    showstringspaces=false,
    captionpos=b,
    backgroundcolor=\color{gray!5},
    xleftmargin=6pt,
    xrightmargin=4pt,
    aboveskip=3pt,
    belowskip=3pt,
    lineskip=-1.5pt,
    extendedchars=true,
    inputencoding=utf8
}

% 页眉页脚 - 针对横版优化，修复中文显示
\setlength{\headheight}{14pt}
\pagestyle{fancy}
\fancyhf{}
\fancyhead[L]{\small ACM 算法竞赛模板集合}
\fancyhead[C]{\small \leftmark}
\fancyhead[R]{\small 第 \thepage\ 页}
\renewcommand{\headrulewidth}{0.3pt}
\fancyfoot[C]{\tiny 编译时间: \today}

% 超链接设置
\hypersetup{
    colorlinks=true,
    linkcolor=blue!70!black,
    filecolor=magenta,
    urlcolor=cyan!70!black,
    bookmarksnumbered=true,
    bookmarksopen=true,
    pdftitle={ACM算法竞赛模板集合},
    pdfauthor={Auto Generated},
    pdfsubject={Algorithm Templates}
}

% 目录样式调整 - 极度紧凑排版
\setlength{\cftbeforesecskip}{0.5pt}
\setlength{\cftbeforesubsecskip}{0.2pt}
\setlength{\cftbeforesubsubsecskip}{0pt}
\renewcommand{\cftsecfont}{\footnotesize\bfseries\color{blue!70!black}}
\renewcommand{\cftsubsecfont}{\scriptsize\bfseries\color{green!60!black}}
\renewcommand{\cftsubsubsecfont}{\tiny\color{orange!80!black}}

% 目录中包含 subsubsection (文件名)
\setcounter{tocdepth}{3}

% 调整目录页码显示 - 更小字体
\renewcommand{\cftsecpagefont}{\footnotesize}
\renewcommand{\cftsubsecpagefont}{\scriptsize}
\renewcommand{\cftsubsubsecpagefont}{\tiny}

% 极度收紧目录排版 - 减少间距和缩进
\renewcommand{\cftsecleader}{\cftdotfill{\cftsecdotsep}}
\renewcommand{\cftsubsecleader}{\cftdotfill{\cftsubsecdotsep}}
\renewcommand{\cftsubsubsecleader}{\cftdotfill{\cftsubsubsecdotsep}}
\setlength{\cftsecnumwidth}{1.2em}
\setlength{\cftsubsecnumwidth}{1.6em}
\setlength{\cftsubsubsecnumwidth}{2.2em}
\setlength{\cftsubsecindent}{1.2em}
\setlength{\cftsubsubsecindent}{2.8em}

% 减少目录整体行间距
\setlength{\cftparskip}{-6pt}
\setlength{\cftaftertoctitleskip}{4pt}

% 自定义目录标题样式 - 更紧凑
\renewcommand{\contentsname}{\normalsize\bfseries 目录}
\setlength{\cftbeforetoctitleskip}{0pt}

% 列表设置
\setlist[itemize]{itemsep=0pt, parsep=0pt, topsep=2pt}
\setlist[enumerate]{itemsep=0pt, parsep=0pt, topsep=2pt}

% 段落设置 - 极度紧凑
\setlength{\parskip}{1pt}
\setlength{\parindent}{0pt}

\title{\LARGE\textbf{ACM 算法竞赛模板集合}}
\author{\large Aiza \\ \normalsize 编译时间: \today}
\date{}

\begin{document}

% 标题页 - 单列
\onecolumn
\maketitle

\vspace{2cm}
\begin{center}
\large
本文档包含了常用的 ACM 算法竞赛模板代码，\\
按照算法类型进行分类整理。

% \vspace{1cm}
% \normalsize
% \textbf{说明：}
% \begin{itemize}
    % \item 代码使用 C++ 编写
    % \item 所有模板都经过测试验证
    % \item 建议根据具体题目需求进行适当修改
    % \item 代码中的注释提供了算法的关键信息
% \end{itemize}
\end{center}

\newpage

% 目录页 - 双列，紧凑布局
\twocolumn
% 减少目录标题上方空白
\vspace*{-1.5cm}
\tableofcontents
% 减少目录下方空白
\vspace*{-1cm}
\newpage

%__AUTO_INSERTED_CONTENT__

\end{document}
